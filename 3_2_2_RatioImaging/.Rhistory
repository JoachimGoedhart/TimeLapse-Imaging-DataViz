setwd("~/surfdrive/Manuscripts/Book-chapter-DataViz-TimeLapse/TimeLapse-Imaging-DataViz_Github/3_2_2_RatioImaging")
#Read the results file generated by FIJI
df_CFP <- read.csv("Results-CFP.csv")
require(tidyverse)
require(tidyverse)
#Read the results file generated by FIJI
df_CFP <- read.csv("Results-CFP.csv")
df_YFP <- read.csv("Results-YFP.csv")
#Split the column 'Label' into three separate columns, using the colon as delimiter
df_split_CFP <- df_CFP %>% separate(Label,c("filename", "Sample","Number"),sep=':')
df_split_YFP <- df_YFP %>% separate(Label,c("filename", "Sample","Number"),sep=':')
#Rename the column with mean intensity
df_split_CFP <- df_split_CFP %>% select(Sample, Mean, Slice) %>% rename('Mean_CFP'='Mean')
df_split_YFP <- df_split_YFP %>% select(Sample, Mean, Slice) %>% rename('Mean_YFP'='Mean')
#Unite the two dataframes
df <- full_join(df_split_YFP, df_split_CFP, by = c("Sample","Slice"))
#Normalization (here on the average of the first 5 time point)
df <- df %>% group_by(Sample) %>% mutate(norm_YFP=Mean_YFP/mean(Mean_YFP[1:5]),
norm_CFP=Mean_CFP/mean(Mean_CFP[1:5]))
#Calculate ratio
df <- df %>% mutate(ratio=norm_YFP/norm_CFP)
#Plot
ggplot(data=df, aes(x=Slice, y=ratio, color=Sample))+geom_line()
View(df)
#Normalization (here on the average of the first 5 time point)
df <- df %>% group_by(Sample) %>% mutate(norm_YFP=Mean_YFP/mean(Mean_YFP[1:5]),
norm_CFP=Mean_CFP/mean(Mean_CFP[1:5]))
#Calculate ratio
df <- df %>% mutate(ratio=norm_YFP/norm_CFP)
#Add the time information based on a (known) interval (here we use 2 seconds):
df <- df %>% mutate(Time=Slice*2)
#Plot
ggplot(data=df, aes(x=Time, y=ratio, color=Sample))+geom_line()
#Save the processed data as a new csv file
write.csv(df, 'Normalized_data.csv')
foo <- 'helle_my_dear'
foo <- 'helle_my_dear'
gsub(".*:","",foo)
gsub(".*_","",foo)
shiny::runApp('~/surfdrive/Shiny-project/PlotTwist')
runApp('~/surfdrive/Shiny-project/PlotTwist')
df$id <- "1"
View(df)
#Save the processed data as a new csv file
write.csv(df, 'Normalized_data.csv')
#Plot
ggplot(data=df, aes(x=Time, y=ratio, color=Sample))+geom_line()
runApp('~/surfdrive/Shiny-project/PlotTwist')
gsub(".*_","",foo)
View(df)
gsub(".*.","",df$Mean_CFP)
gsub(".*-","",df$Sample)
runApp('~/surfdrive/Shiny-project/PlotTwist')
runApp('~/surfdrive/Shiny-project/PlotTwist')
runApp('~/surfdrive/Shiny-project/PlotTwist')
df_CFP <- read.csv("Results-CFP.csv")
df_YFP <- read.csv("Results-YFP.csv")
df_CFP <- read.csv("Results-CFP.csv")
df_YFP <- read.csv("Results-YFP.csv")
df_CFP <- read.csv("Results-CFP.csv")
df_YFP <- read.csv("Results-YFP.csv")
ggplot(data=df, aes(x=Time, y=ratio, color=Sample))+geom_line()+
theme_light(base_size = 16) +
ylab("Normalized Ratio") + xlab("Time [s]") +
ggtitle("G-protein activation by histamine")
#Plot
ggplot(data=df, aes(x=Time, y=ratio, color=Sample))+geom_line()+
theme_light(base_size = 16) +
ylab("Normalized Ratio") + xlab("Time [s]") +
ggtitle("Calcium oscillations induced by histamine")
#Plot
ggplot(data=df, aes(x=Time, y=ratio, color=Sample))+geom_line(size=2)+
theme_light(base_size = 16) +
ylab("Normalized Ratio") + xlab("Time [s]") +
ggtitle("Calcium oscillations induced by histamine")
#Plot
ggplot(data=df, aes(x=Time, y=ratio, color=Sample))+geom_line(size=1)+
theme_light(base_size = 16) +
ylab("Normalized Ratio") + xlab("Time [s]") +
ggtitle("Calcium oscillations induced by histamine")
#Plot
ggplot(data=df, aes(x=Time, y=ratio, color=Sample))+geom_line(size=1)+
theme_light(base_size = 16) +
ylab("Normalized Ratio") + xlab("Time [s]") +
ggtitle("Calcium oscillations induced by histamine")+facet_wrap(Sample)
#Plot
ggplot(data=df, aes(x=Time, y=ratio, color=Sample))+geom_line(size=1)+
theme_light(base_size = 16) +
ylab("Normalized Ratio") + xlab("Time [s]") +
ggtitle("Calcium oscillations induced by histamine")+facet_wrap(~Sample)
#Plot
ggplot(data=df, aes(x=Time, y=ratio, color=Sample))+geom_line(size=1)+
theme_light(base_size = 16) +
ylab("Normalized Ratio") + xlab("Time [s]") + theme(legend.position="none")+
ggtitle("Calcium oscillations induced by histamine")+facet_wrap(~Sample)+
#Plot
ggplot(data=df, aes(x=Time, y=ratio, color=Sample))+geom_line(size=1)+
theme_light(base_size = 16) +
ylab("Normalized Ratio") + xlab("Time [s]") + theme(legend.position="none")+
ggtitle("Calcium oscillations induced by histamine")+facet_wrap(~Sample)
#Plot
ggplot(data=df, aes(x=Time, y=ratio, color=Sample))+geom_line(size=1)+
theme_light(base_size = 16) +
ylab("Normalized Ratio") + xlab("Time [s]") + theme(legend.position="none")+
ggtitle("Calcium oscillations induced by histamine")+facet_wrap(~Sample)
#Plot
ggplot(data=df, aes(x=Time, y=ratio, group=Sample))+geom_line(size=1)+
theme_light(base_size = 16) +
ylab("Normalized Ratio") + xlab("Time [s]") + theme(legend.position="none")+
ggtitle("Calcium oscillations induced by histamine")+facet_wrap(~Sample)
ggplot(data=df, aes(x=Time, y=ratio, group=Sample))+geom_line(size=1)+
theme_light(base_size = 16) +
ylab("Normalized Ratio") + xlab("Time [s]") +
theme(legend.position="none") +
ggtitle("Calcium oscillations induced by histamine") +
# facet_wrap(~Sample) +
NULL
#Plot - By turning a line of code into a comment with a '#', the effect of different functions can be discovered
ggplot(data=df, aes(x=Time, y=ratio, group=Sample))+geom_line(size=1)+
theme_light(base_size = 16) +
ylab("Normalized Ratio") + xlab("Time [s]") +
# theme(legend.position="none") +
ggtitle("Calcium oscillations induced by histamine") +
facet_wrap(~Sample) +
NULL
ggplot(data=df, aes(x=Time, y=ratio, group=Sample))+geom_line(size=1)+
theme_light(base_size = 16) +
ylab("Normalized Ratio") + xlab("Time [s]") +
# theme(legend.position="none") +
ggtitle("Calcium oscillations induced by histamine") +
facet_wrap(~Sample) +
NULL
df <- df %>% mutate(Time=Slice*2)
#Save the processed data as a new csv file
write.csv(df, 'Normalized_data.csv')
#Plot - By turning a line of code into a comment with a '#', the effect of different functions can be discovered
ggplot(data=df, aes(x=Time, y=ratio, group=Sample))+geom_line(size=1)+
theme_light(base_size = 16) +
ylab("Normalized Ratio") + xlab("Time [s]") +
ggtitle("Calcium oscillations induced by histamine") +
facet_wrap(~Sample) +
NULL
ggplot(data=df, aes(x=Time, y=ratio, group=Sample))+geom_line(size=1)+
# theme_light(base_size = 16) +
ylab("Normalized Ratio") + xlab("Time [s]") +
theme(legend.position="none") +
ggtitle("Calcium oscillations induced by histamine") +
facet_wrap(~Sample) +
NULL
#Plot - By turning a line of code into a comment with a '#', the effect of different functions can be discovered
ggplot(data=df, aes(x=Time, y=ratio, group=Sample, color=Sample))+geom_line(size=1)+
theme_light(base_size = 16) +
ylab("Normalized Ratio") + xlab("Time [s]") +
theme(legend.position="none") +
ggtitle("Calcium oscillations induced by histamine") +
facet_wrap(~Sample) +
NULL
ggplot(data=df, aes(x=Time, y=ratio, group=Sample, color=Sample))+geom_line(size=1)+
theme_light(base_size = 16) +
ylab("Normalized Ratio") + xlab("Time [s]") +
# theme(legend.position="none") +
ggtitle("Calcium oscillations induced by histamine") +
facet_wrap(~Sample) +
NULL
runApp('~/surfdrive/Shiny-project/PlotTwist')
runApp('~/surfdrive/Shiny-project/PlotTwist')
runApp('~/surfdrive/Shiny-project/PlotTwist')
runApp('~/surfdrive/Shiny-project/PlotTwist')
runApp('~/surfdrive/Shiny-project/PlotTwist')
runApp('~/surfdrive/Shiny-project/PlotTwist')
runApp('~/surfdrive/Shiny-project/PlotTwist')
